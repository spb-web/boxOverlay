function t(t,e){for(var n=t&&t.firstChild;n;){if(n===e)return!0;n=n.nextSibling}return!1}var e=function(){function e(){this.element=document.createElement("div"),this.style={color:"rgba(0,0,0,.5)",borderRadius:5,zIndex:1e4},this.element.style.position="fixed",this.element.style.left="0",this.element.style.top="0",this.element.style.pointerEvents="none",this.applyStyle()}return Object.defineProperty(e.prototype,"color",{get:function(){return this.style.color},set:function(t){var e=this;this.style.color=t,requestAnimationFrame((function(){e.applyStyle()}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"borderRadius",{get:function(){return this.style.borderRadius},set:function(t){var e=this;this.style.borderRadius=t,requestAnimationFrame((function(){e.applyStyle()}))},enumerable:!1,configurable:!0}),e.prototype.getElement=function(){return this.element},e.prototype.setRect=function(t){t?(this.mount(),this.element.style.transform="translate("+t.x+"px, "+t.y+"px)",this.element.style.width=t.width+"px",this.element.style.height=t.height+"px"):this.destroy()},e.prototype.mount=function(){t(document.body,this.element)||document.body.appendChild(this.element)},e.prototype.destroy=function(){t(document.body,this.element)&&document.body.removeChild(this.element)},e.prototype.applyStyle=function(){this.element.style.setProperty("box-shadow","0 0 0 20000px "+this.style.color),this.element.style.setProperty("border-radius",this.style.borderRadius+"px"),this.element.style.setProperty("z-index",""+this.style.zIndex)},e}(),n=function(){function t(t){void 0===t&&(t=function(t){}),this.overlay=new e,this.elements=[],this.rect=null,this.requestAnimationFrameId=-1,this.handleUpdate=t}return t.prototype.add=function(t){var e;try{var n=this.getElements(t);(e=this.elements).push.apply(e,n)}catch(t){console.error(t)}},t.prototype.remove=function(t){this.elements="string"==typeof t?this.elements.filter((function(e){return!e.matches(t)})):this.elements.filter((function(e){return e!==t}))},t.prototype.clear=function(){this.elements=[]},t.prototype.getElements=function(t){if("string"==typeof t){var e=document.querySelectorAll(t);if(!e)throw new Error("Can not find element by selector "+t);return e}return[t]},t.prototype.getPosition=function(t){return t.getBoundingClientRect()},t.prototype.calcBox=function(){if(0!==this.elements.length){null===this.rect?this.rect=new DOMRect(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,0,0):(this.rect.x=Number.MAX_SAFE_INTEGER,this.rect.y=Number.MAX_SAFE_INTEGER,this.rect.width=0,this.rect.height=0);var t=this.rect,e=0,n=0;this.elements.map(this.getPosition).forEach((function(i){t.x=Math.min(i.x,t.x),t.y=Math.min(i.y,t.y),n=Math.max(i.x+i.width,n),e=Math.max(i.y+i.height,e)})),t.width=n-t.x,t.height=e-t.y}else this.rect=null},t.prototype.start=function(){this.watch()},t.prototype.stop=function(){cancelAnimationFrame(this.requestAnimationFrameId),this.requestAnimationFrameId=-1,this.overlay.destroy()},t.prototype.watch=function(){var t=this;this.calcBox(),this.handleUpdate(this.rect),this.overlay.setRect(this.rect),this.requestAnimationFrameId=requestAnimationFrame((function(){t.watch()}))},t}();export{n as OverlayBox};
